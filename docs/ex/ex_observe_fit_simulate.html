<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Ullrika Sahlin">

<title>Observe, fit and simulate â€“ MVEN10</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="../site_libs/font-awesome-5.13.0/js/script.js"></script>



<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-sidebar docked">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../ex/ex_exposure_assessment_databases.html">Sept 16</a></li><li class="breadcrumb-item"><a href="../ex/ex_observe_fit_simulate.html">Exercise Observe, fit model (and simulate)</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../">MVEN10</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Sept 6</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../ex/expressing_uncertainty.html" class="sidebar-item-text sidebar-link" target="_blank">
 <span class="menu-text">Exercise Uncertainty</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../ex/useful_functions.html" class="sidebar-item-text sidebar-link" target="_blank">
 <span class="menu-text">Useful functions in Excel</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">Sept 9</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../ex/chance_belief_frequency.html" class="sidebar-item-text sidebar-link" target="_blank">
 <span class="menu-text">Exercise Probability</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../ex/introduction_to_quarto_and_R.html" class="sidebar-item-text sidebar-link" target="_blank">
 <span class="menu-text">Intro to Quarto and R</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">Sept 13</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../ex/useful_functions_with_R.html" class="sidebar-item-text sidebar-link" target="_blank">
 <span class="menu-text">Useful functions in R</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../ex/ex_observe_summarise.html" class="sidebar-item-text sidebar-link" target="_blank">
 <span class="menu-text">Exercise Observe and summarise</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true">
 <span class="menu-text">Sept 16</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../ex/ex_exposure_assessment_databases.html" class="sidebar-item-text sidebar-link" target="_blank">
 <span class="menu-text">Exercise Exposure databases</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../ex/ex_environ_fate_assessment.html" class="sidebar-item-text sidebar-link" target="_blank">
 <span class="menu-text">Exercise Exposure assessment</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../ex/ex_observe_fit_simulate.html" class="sidebar-item-text sidebar-link active" target="_blank">
 <span class="menu-text">Exercise Observe, fit model (and simulate)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../ex/ex_env_hazard_assessment.html" class="sidebar-item-text sidebar-link" target="_blank">
 <span class="menu-text">Exercise Hazard assessment</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true">
 <span class="menu-text">Sept 18</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
 <span class="menu-text">Exercise Environmental health risk assessment (canvas)</span>
  </li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true">
 <span class="menu-text">Sept 23</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../ex/ex_benchmark_dose_modelling.html" class="sidebar-item-text sidebar-link" target="_blank">
 <span class="menu-text">Exercise Benchmark Dose Modelling</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../ex/ex_causal_inference.html" class="sidebar-item-text sidebar-link" target="_blank">
 <span class="menu-text">Exercise Causal inference</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="true">
 <span class="menu-text">Sept 30</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../ex/ex_daily_intake_equation.html" class="sidebar-item-text sidebar-link" target="_blank">
 <span class="menu-text">Exercise Uncertainty Interval analysis</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../ex/ex_daily_intake_equation_MC.html" class="sidebar-item-text sidebar-link" target="_blank">
 <span class="menu-text">Exercise Uncertainty Monte Carlo simulation</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" role="navigation" aria-expanded="true">
 <span class="menu-text">Oct 1</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-8" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
 <span class="menu-text">Exercise Species Distribution Modelling (canvas)</span>
  </li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" role="navigation" aria-expanded="true">
 <span class="menu-text">Oct 2</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-9" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
 <span class="menu-text">Exposure assessment using a model for bioaccumulation</span>
  </li>
          <li class="sidebar-item">
 <span class="menu-text">Exercise Risk classification</span>
  </li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-10" role="navigation" aria-expanded="true">
 <span class="menu-text">Oct 7</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-10" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-10" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
 <span class="menu-text">Exercise Expert Elicitation</span>
  </li>
          <li class="sidebar-item">
 <span class="menu-text">Exercise Assessment of overall uncertainty</span>
  </li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#exercise-overview" id="toc-exercise-overview" class="nav-link active" data-scroll-target="#exercise-overview">Exercise overview</a>
  <ul class="collapse">
  <li><a href="#background" id="toc-background" class="nav-link" data-scroll-target="#background">Background</a></li>
  <li><a href="#purpose" id="toc-purpose" class="nav-link" data-scroll-target="#purpose">Purpose</a></li>
  <li><a href="#content" id="toc-content" class="nav-link" data-scroll-target="#content">Content</a></li>
  <li><a href="#duration" id="toc-duration" class="nav-link" data-scroll-target="#duration">Duration</a></li>
  <li><a href="#reporting" id="toc-reporting" class="nav-link" data-scroll-target="#reporting">Reporting</a></li>
  </ul></li>
  <li><a href="#choose-data-set" id="toc-choose-data-set" class="nav-link" data-scroll-target="#choose-data-set">Choose data set</a></li>
  <li><a href="#find-a-suitable-model-for-data" id="toc-find-a-suitable-model-for-data" class="nav-link" data-scroll-target="#find-a-suitable-model-for-data">Find a suitable model for data</a>
  <ul class="collapse">
  <li><a href="#fit-a-model" id="toc-fit-a-model" class="nav-link" data-scroll-target="#fit-a-model">Fit a model</a></li>
  </ul></li>
  <li><a href="#simulate" id="toc-simulate" class="nav-link" data-scroll-target="#simulate">Simulate</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../ex/ex_exposure_assessment_databases.html">Sept 16</a></li><li class="breadcrumb-item"><a href="../ex/ex_observe_fit_simulate.html">Exercise Observe, fit model (and simulate)</a></li></ol></nav>
<div class="quarto-title">
<h1 class="title">Observe, fit and simulate</h1>
<p class="subtitle lead">MVEN10 Risk Assessment in Environment and Public Health</p>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Ullrika Sahlin </p>
          </div>
  </div>
    
  
    
  </div>
  


</header>


<section id="exercise-overview" class="level2">
<h2 class="anchored" data-anchor-id="exercise-overview">Exercise overview</h2>
<ul>
<li><p>We encourage collaboration</p></li>
<li><p>Reporting is individual</p></li>
</ul>
<section id="background" class="level3">
<h3 class="anchored" data-anchor-id="background">Background</h3>
<p>Assessors often face the task to inform a model with available data.</p>
<p>The way data has been collected gives valuable information on how data is related to the quantity</p>
<p>Sample size, or rather the number of independent observations, should be large enough to establish a good fit.</p>
</section>
<section id="purpose" class="level3">
<h3 class="anchored" data-anchor-id="purpose">Purpose</h3>
<ul>
<li><p>To find a suitable probability model (a probability distribution) for variability or measurement errors of a given random sample (repeated observations of he same thing), by</p></li>
<li><p>Estimating the model parameters using the information in the sample, and</p></li>
<li><p>Evaluate the goodness of fit of the model, and then</p></li>
<li><p>draw random numbers from the probability model (a probability distribution)</p></li>
</ul>
</section>
<section id="content" class="level3">
<h3 class="anchored" data-anchor-id="content">Content</h3>
<ul>
<li><p>Data sets collected by the students</p></li>
<li><p>Functions to fit a model to data and evaluate goodness of fit</p></li>
</ul>
</section>
<section id="duration" class="level3">
<h3 class="anchored" data-anchor-id="duration">Duration</h3>
<p>60 minutes</p>
</section>
<section id="reporting" class="level3">
<h3 class="anchored" data-anchor-id="reporting">Reporting</h3>
<p>Write a report using a qmd document and upload it on the assignment in canvas. Instructions at the end of this page.</p>
</section>
</section>
<section id="choose-data-set" class="level2">
<h2 class="anchored" data-anchor-id="choose-data-set">Choose data set</h2>
<ol class="example" type="1">
<li>Download the fill with all data sets and upload it in your project in the folder named <strong>data</strong></li>
</ol>
<div class="cell">
<div class="cell-output-display">
<button class="btn btn-info" onclick="fetch('data:application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;base64,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').then(res => res.blob()).then(blob => {
      const downloadURL = window.URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.style.display = 'none'; // Hide the link
      document.body.appendChild(a);
      a.href = downloadURL;
      a.download = 'ex_obs_all.xlsx';
      a.click();
      window.URL.revokeObjectURL(downloadURL);
      document.body.removeChild(a);
      return false;
    });"><i class="fa fa-save"></i> lengths of blocks 1</button>
</div>
</div>
<ol start="2" class="example" type="1">
<li><p>Open the excel-file and see what it contains.</p></li>
<li><p>Load useful libraries for reading and plotting data</p></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol start="4" class="example" type="1">
<li>Read in data into a data frame named <strong>df</strong> and view it.</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="at">path=</span><span class="st">"data/ex_obs_all.xlsx"</span>,<span class="at">sheet=</span><span class="st">"data"</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">View</span>(df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>You are to use R to fit a probability distribution to the observations to two groups, one with discrete and one with continious observations.</p>
<ol start="5" class="example" type="1">
<li><p>Choose one of the columns to start with.</p></li>
<li><p>Decide if the data you have selected is continuous or discrete.</p></li>
</ol>
<p>Below I refer to the column name for the chosen observations as <strong>obs</strong>. Note that I demonstrate the code on a different data set than yours.</p>
<p>This is my set of observations</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>obs</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code> [1]  172.4   15.5    3.8   35.5   21.8 1568.3   25.1    5.4   20.1   42.9
[11]   65.9    5.5  111.7   84.7    0.1  345.9   24.7   13.9    4.5   29.5</code></pre>
</div>
</div>
<ol start="7" class="example" type="1">
<li>Make a histogram of data.</li>
</ol>
<p>Change <em>binwidth</em> to modify the smoothness of the histogram.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df,<span class="fu">aes</span>(<span class="at">x=</span>obs))<span class="sc">+</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">60</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ex_observe_fit_simulate_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="find-a-suitable-model-for-data" class="level2">
<h2 class="anchored" data-anchor-id="find-a-suitable-model-for-data">Find a suitable model for data</h2>
<p>We will find a suitable model for data by fitting a probability distribution to data.</p>
<blockquote class="blockquote">
<p>A distribution that fits well to data AND that seems reasonable for that quantity can be seen as a suitable model to describe variability for the quantity and/or measurement error for observations of the quantity.</p>
</blockquote>
<ol start="8" class="example" type="1">
<li>Install the R-package <strong>fitdistrplus</strong>.</li>
</ol>
<p>Note that this only needs to be done one time and you can do it in the Console.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"fitdistrplus"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol start="9" class="example" type="1">
<li>Load the R-package <strong>fitdistrplus</strong> and ignore warnings</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(fitdistrplus)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="fit-a-model" class="level3">
<h3 class="anchored" data-anchor-id="fit-a-model">Fit a model</h3>
<p>We will find a model by fitting alternative reasonable probability distributions to data and then compare the fitted distributions.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true" aria-current="page">Continuous quantity</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false">Discrete quantity</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<p>We will use a <em>normal</em>, <em>lognormal</em> and an <em>exponential</em> distribution as candidate models for the continuous quantity.</p>
<ul>
<li>Fit a normal distribution to data using the function <em>fitdist</em></li>
</ul>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>Note that you can type a question mark in front of a function in the Console to view the help for the function</p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>fitnorm <span class="ot">=</span> <span class="fu">fitdist</span>(df<span class="sc">$</span>obs, <span class="at">distr =</span> <span class="st">"norm"</span>)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>fitnorm</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Fitting of the distribution ' norm ' by maximum likelihood 
Parameters:
     estimate Std. Error
mean  129.860   75.86764
sd    339.284   53.64652</code></pre>
</div>
</div>
<ul>
<li>Study goodness of fit by comparing the histogram and fitted PDF and Empirical and theoretical CDFs. Note that if your plotting window is too small, then use zoom to enlarge it.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(fitnorm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ex_observe_fit_simulate_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<ul>
<li>Fit data to a lognormal distribution and view the PDF, CDF and quantiles</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>fitlnorm <span class="ot">=</span> <span class="fu">fitdist</span>(df<span class="sc">$</span>obs, <span class="at">distr =</span> <span class="st">"lnorm"</span>)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>fitlnorm</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Fitting of the distribution ' lnorm ' by maximum likelihood 
Parameters:
        estimate Std. Error
meanlog 3.211113  0.4333823
sdlog   1.938145  0.3064472</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(fitlnorm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ex_observe_fit_simulate_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<ul>
<li>Fit data to an exponential distribution and view the PDF, CDF and quantiles</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>fitexp <span class="ot">=</span> <span class="fu">fitdist</span>(df<span class="sc">$</span>obs, <span class="at">distr =</span> <span class="st">"exp"</span>)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>fitexp</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Fitting of the distribution ' exp ' by maximum likelihood 
Parameters:
        estimate  Std. Error
rate 0.007700601 0.001692276</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(fitexp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ex_observe_fit_simulate_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>In addition to studying graphs, one can compare a measures of goodness-of-fit.</p>
<ul>
<li>Compare the goodness-of-fit measure AIC, where the lower AIC is the better.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>fitnorm<span class="sc">$</span>aic</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 293.831</code></pre>
</div>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>fitlnorm<span class="sc">$</span>aic</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 215.6713</code></pre>
</div>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>fitexp<span class="sc">$</span>aic</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 236.6583</code></pre>
</div>
</div>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code> [1] 2 1 1 3 3 3 2 3 2 2 3 2 1 1 2 2 2 0 3 0</code></pre>
</div>
</div>
<p>We will use <em>negative binomial</em>, <em>binomial</em> and <em>poisson</em> as candidate distributions for the discrete quantity.</p>
<ul>
<li>Fit a negative binomial distribution to data using the function <em>fitdist</em></li>
</ul>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>Note that you can type a question mark in front of a function in the Console to view the help</p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>fitnbinom <span class="ot">=</span> <span class="fu">fitdist</span>(df<span class="sc">$</span>obs, <span class="at">distr =</span> <span class="st">"nbinom"</span>, <span class="at">discrete=</span><span class="cn">TRUE</span>)</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>fitnbinom</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Fitting of the distribution ' nbinom ' by maximum likelihood 
Parameters:
         estimate Std. Error
size 4.786307e+06 86.7613284
mu   1.899789e+00  0.3081865</code></pre>
</div>
</div>
<ul>
<li>Plot the fitted distribution and compare to data. Note that the plotting looks different from discrete data.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(fitnbinom)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ex_observe_fit_simulate_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<ul>
<li>Fit a binomial distribution to data</li>
</ul>
<p>Note that in order to use the binomial you need to fix the number of trials and suggest a starting value for the probability to succeed in one trial.</p>
<p>In the code below, the binomial model is fitted using <em>quantile matching estimation</em>, and that is why we also provide two quantiles (<em>probs</em>) as input arguments to the function. The size parameter corresonds to the number of indpendent trials, and you can modify that to be smaller och larger integer.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>fitbinom <span class="ot">=</span> <span class="fu">fitdist</span>(df<span class="sc">$</span>obs, <span class="at">distr =</span> <span class="st">"binom"</span>, <span class="at">discrete=</span><span class="cn">TRUE</span>, <span class="at">start=</span> <span class="fu">list</span>(<span class="at">size =</span> <span class="dv">20</span>, <span class="at">prob =</span> <span class="fu">mean</span>(df<span class="sc">$</span>obs)<span class="sc">/</span><span class="dv">20</span>), <span class="at">method =</span> <span class="st">"qme"</span>, <span class="at">probs =</span> <span class="fu">c</span>(<span class="fl">0.25</span>,<span class="fl">0.75</span>))</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>fitbinom</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Fitting of the distribution ' binom ' by matching quantiles 
Parameters:
     estimate
size   20.000
prob    0.095</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(fitbinom)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ex_observe_fit_simulate_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<ul>
<li>Fit a poisson distribution to data</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>fitpois <span class="ot">=</span> <span class="fu">fitdist</span>(df<span class="sc">$</span>obs, <span class="at">distr =</span> <span class="st">"pois"</span>, <span class="at">discrete=</span><span class="cn">TRUE</span>)</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>fitpois</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Fitting of the distribution ' pois ' by maximum likelihood 
Parameters:
       estimate Std. Error
lambda      1.9  0.3082206</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(fitpois)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ex_observe_fit_simulate_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>In addition to studying graphs, one can compare a measures of goodness-of-fit.</p>
<ul>
<li>Compare the goodness-of-fit measure AIC, where the lower AIC is the better.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>fitnbinom<span class="sc">$</span>aic</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 63.81058</code></pre>
</div>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>fitbinom<span class="sc">$</span>aic</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 62.78103</code></pre>
</div>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>fitpois<span class="sc">$</span>aic</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 61.81057</code></pre>
</div>
</div>
</div>
</div>
</div>
<ol start="10" class="example" type="1">
<li>Choose the best model and justify your decision</li>
</ol>
</section>
</section>
<section id="simulate" class="level2">
<h2 class="anchored" data-anchor-id="simulate">Simulate</h2>
<p>At this point you have a model for a quantity that is either a continuous or a discrete variable.</p>
<p>Now you are to simulate from the continuous model and visualise the results. Simulation is done by generating random numbers from the chosen probability distribution.</p>
<ol start="11" class="example" type="1">
<li>Sample 10 000 random values from your choice of the best model.</li>
</ol>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-2-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-1" role="tab" aria-controls="tabset-2-1" aria-selected="true">Simulate Normal</a></li></ul>
<div class="tab-content">
<div id="tabset-2-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-2-1-tab">
<p>Here is a code how to sample ten values from a fitted normal distribution.</p>
<ul>
<li>The parameters of the fitted distribution is found by typing <strong>$estimate</strong> after the fitted object. For a normal it is:</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>fitnorm<span class="sc">$</span>estimate</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   mean      sd 
129.860 339.284 </code></pre>
</div>
</div>
<ul>
<li>use the function <em>rnorm</em> to sample <em>niter = 10</em> values</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>niter <span class="ot">=</span> <span class="dv">10</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a><span class="fu">rnorm</span>(niter,fitnorm<span class="sc">$</span>estimate[<span class="st">"mean"</span>],fitnorm<span class="sc">$</span>estimate[<span class="st">"sd"</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1]  262.28018  241.93107   56.74759 -123.36415  642.44222  286.19451
 [7]  468.04456 -137.44247  -45.72133 -305.63053</code></pre>
</div>
</div>
<ul>
<li>sample and plot as a histogram.</li>
</ul>
<p>Here is a code how to do it for the normal distribution.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(<span class="at">x=</span><span class="fu">rnorm</span>(niter,fitnorm<span class="sc">$</span>estimate[<span class="st">"mean"</span>],fitnorm<span class="sc">$</span>estimate[<span class="st">"sd"</span>])) <span class="sc">%&gt;%</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>x)) <span class="sc">+</span></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ex_observe_fit_simulate_files/figure-html/unnamed-chunk-27-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<!-- ### Simulate Poisson -->
<!-- Here is a code how to sample ten values from a fitted poisson distribution. -->
<!-- - The parameters of the fitted distribution is found by typing **$estimate** after the fitted object. For a poisson it is: -->
<!-- ```{r} -->
<!-- fitpois$estimate -->
<!-- ``` -->
<!-- - use the function *rpois* to sample *niter = 10* values -->
<!-- ```{r} -->
<!-- niter = 10 -->
<!-- rpois(niter,fitpois$estimate["lambda"]) -->
<!-- ``` -->
<!-- - sample and plot as a histogram. -->
<!-- Here is a code how to do it for the normal distribution. -->
<!-- ```{r} -->
<!-- #| warning: false -->
<!-- #| message: false -->
<!-- data.frame(x=rpois(niter,fitpois$estimate["lambda"])) %>% -->
<!--   ggplot(aes(x=x)) + -->
<!--   geom_histogram() -->
<!-- ``` -->
<!-- :::: -->
<section id="report" class="level2">
<h2 class="anchored" data-anchor-id="report">Report</h2>
<p>Prepare a report including:</p>
<ul>
<li><p>your name</p></li>
<li><p>your choice of the two data sets</p></li>
<li><p>your chosen models</p></li>
<li><p>include your justification</p>
<ul>
<li>refer to if the data is for a continuous or discrete quantity</li>
<li>the goodness-of-fit measured by AIC in comparison to alternative models</li>
<li>a graph comparing the histogram with the PDF of the fitted model and the empirical and theoretical CDFs</li>
</ul></li>
<li><p>a histogram visualising a random sample of 10 000 values from the quantity</p></li>
</ul>
<p>Use this template for the report</p>
<div class="cell">
<div class="cell-output-display">
<button class="btn btn-warning" onclick="fetch('data:application/octet-stream;base64,LS0tDQp0aXRsZTogIkV4ZXJjaXNlIE9ic2VydmUsIGZpdCBhbmQgc2ltdWxhdGUiDQpzdWJ0aXRsZTogIlJlcG9ydCINCmF1dGhvcjogIlBVVCBZT1VSIE5BTUUgSEVSRSINCmRhdGU6IHRvZGF5DQpmb3JtYXQ6IA0KICBodG1sOg0KICAgIHRvYzogdHJ1ZQ0KICAgIGNvZGUtZm9sZDogdHJ1ZQ0KICAgIGVjaG86IGZhbHNlDQogICAgbWVzc2FnZTogZmFsc2UNCiAgICB3YXJuaW5nOiBmYWxzZQ0KICAgIGVtYmVkLXJlc291cmNlczogdHJ1ZQ0KZWRpdG9yOiB2aXN1YWwNCi0tLQ0KDQpgYGB7cn0NCiN8IHdhcm5pbmc6IGZhbHNlDQojfCBtZXNzYWdlOiBmYWxzZQ0KDQpsaWJyYXJ5KHJlYWR4bCkNCmxpYnJhcnkoZHBseXIpDQpsaWJyYXJ5KGdncGxvdDIpDQoNCmxpYnJhcnkoZml0ZGlzdHJwbHVzKQ0KYGBgDQoNCiMjIERpc2NyZXRlIGRhdGEgIA0KDQojIyBNb2RlbCBmb3IgZGlzY3JldGUgZGF0YQ0KDQojIyBKdXN0aWZpY2F0aW9uIGZvciB0aGUgY2hvaWNlIG9mIG1vZGVsDQoNCiMjIENvbnRpbnVvdXMgZGF0YSAgDQoNCiMjIE1vZGVsIGZvciBjb250aW51b3VzIGRhdGENCg0KIyMgSnVzdGlmaWNhdGlvbiBmb3IgdGhlIGNob2ljZSBvZiBtb2RlbA0KDQojIyBTaW11bGF0aW9uIGZyb20gdGhlIG1vZGVsIHdpdGggY29udGludW91cyBkYXRhDQo=').then(res => res.blob()).then(blob => {
      const downloadURL = window.URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.style.display = 'none'; // Hide the link
      document.body.appendChild(a);
      a.href = downloadURL;
      a.download = 'ex_sim_report_template.qmd';
      a.click();
      window.URL.revokeObjectURL(downloadURL);
      document.body.removeChild(a);
      return false;
    });"><i class="fa fa-save"></i> template for report observe fit simulate</button>
</div>
</div>


</section>
</div>
</div>
</div>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "î§‹";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>